{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Gender of Selected Astronauts",
  "width": 600,
  "height": 400,
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/jwai0004/FIT3179Assignment2/main/data/astronauts.csv"
      },
      "transform": [
        {"calculate": "datum.sex == 'female' ? 1 : 0", "as": "isFemale"},
        {"calculate": "datum.sex == 'male' ? 1 : 0", "as": "isMale"}
      ],
      "mark": {"type": "area", "interpolate": "step"},
      "encoding": {
        "x": {
          "field": "year_of_selection",
          "title": "Year of Selection for First Mission",
          "timeUnit": "year"
        },
        "y": {
          "field": "number",
          "title": "Proportion Female",
          "aggregate": "count",
          "stack": "normalize",
          "sort": "ascending"
        },
        "color": {
          "field": "isFemale",
          "title": "Gender",
          "scale": {"range": ["#4C78A8", "#B5CF6B"]},
          "legend": {"labelExpr": "datum.value == 1 ? 'Female' : 'Male'", "values": [1, 0]}
        }
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/jwai0004/FIT3179Assignment2/main/data/astronauts.csv"
      },
      "transform": [
        {"calculate": "datum.sex == 'female' ? 1 : 0", "as": "isFemale"},
        {"calculate": "datum.sex == 'male' ? 1 : 0", "as": "isMale"},
        {"calculate": "datum.sex == 'male' || datum.sex == 'female' ? 1 : 0", "as": "all"}
      ],
      "mark": {"type": "area", "opacity": 0},
      "encoding": {
        "x": {
          "field": "year_of_selection",
          "title": "Year of Selection for First Mission",
          "timeUnit": "year"
        },
        "y": {
          "field": "all",
          "aggregate": "average",
          "title": "Proportion Female"
        },
        "tooltip": [
          {"field": "year_of_selection", "title": "Year", "timeUnit": "year"},
          {"field": "isFemale", "aggregate": "sum", "title": "Females"},
          {"field": "isMale", "aggregate": "sum", "title": "Males"}
        ]
      }
    }
  ]
}
